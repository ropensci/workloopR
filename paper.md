---
title: 'workloopR: Analysis of muscle work loops in R'
tags:
  - R
  - muscle physiology
  - work loop
  - twitch
  - tetanus
  - ddf
authors:
  - name: Vikram B. Baliga
    orcid: 0000-0002-9367-8974
    affiliation: 1
  - name: Shreeram Senthivasan
    orcid: 0000-0002-7118-9547
    affiliation: 1
affiliations:
 - name: Department of Zoology, University of British Columbia, Vancouver, British Colombia, Canada V6T 1Z4
   index: 1
date: 18 July 2019
bibliography: paper.bib
---

# Summary

The work loop technique (@Josephson:1985) is used in studies of muscle physiology to determine the mechanical work and power output of a muscle. As shown in Figure 1 (but just for one cycle out of several), a servo motor induces cyclical oscillations of length change.  As this occurs, the muscle is stimulated either directly or via its supplying nerve and the force that is generated is recorded. Plotting force against length change for a particular cycle yields a "work loop". Since mechanical work is the product of force and distance, the area enclosed within the work loop is the net work produced during that cycle. 

![Figure 1](/images/fig1_workloop.png)

Work loop procedures have powerful experimental value. Using experimental parameters (e.g. length change amplitude, frequency of stimulation) that are shown by the organism *in vivo* can help explain muscle performance in the context of natural behavior. But since these experimental parameters do not need to be constrained to those shown during *in vivo* behaviors, the work loop technique affords the ability to explore a muscle's properties beyond (some) natural physiological constraints. {@Anh:2012} provides a review of the work loop technique's importance to the field of muscle physiology.

The ability to import and analyze data from work loop (or other muscle physiology ) experiments has been conspicuously absent from open-source environments. ``workloopR`` (pronounced "work looper") provides functions for the import, transformation, and analysis of muscle physiology experiments in R. As the package's title suggests, our initial motivation was to provide functions to analyze work loops. Over the course of developing the package, we expanded this goal to cover additional types of experiments that are often complementary to the work loop technique. Accordingly, there are three currently supported experiment types: work loop, simple twitch, and tetanus.

Importing data creates objects of class `muscle_stim`, which we designed to essentially behave as `data.frame`s but with unique properties that work nicely with ``workloopR``'s core functions. Data that are stored in .ddf format (e.g. generated by Aurora Scientific's Dynamic Muscle Control and Analysis Software) are easily imported. Other file formats are welcome, but need to be constructed into `muscle_stim` objects by the user.

Prior to analyses, data can be transformed or corrected. Should data have been recorded incorrectly, the gear ratio of the motor arm and/or the direction of the muscle's length change can be adjusted. Before analyzing work loop data, cycles within the work loop can be labeled (according to various definitions of what constitutes a "cycle"), which allows calculation of metrics on a per-cycle basis.

Core data analytical functions include ``analyze_workloop()`` for work loop files and ``isometric_timing()`` for twitch and tetanus trials. ``analyze_workloop()`` computes instantaneous velocity, net work, instantaneous power, and net power for work loop trials on a per-cycle basis. ``isometric_timing()`` provides summarization of kinetics, i.e. the timing and magnitude of force production at various points within the tetanus or twitch trial.

We also include functions for batch processing files (e.g. multiple files from a common experiment). These functions allow for the import, cycle selection, gear ratio correction, and ultimately work & power computation for all work loop trial files within a specified directory.  This also allows users to correct for potential degradation of the muscle (according to power & work output) over the course of the experiment.

Please see Figure 2 below for an overview of the ``workloopR`` package with recommended functions and vignettes. 

![Figure 2](/images/fig2_flowchart.png)

# Acknowledgements

We thank Doug Altshuler, Jasmin Wong, and Jolan Theriault for help they provided throughout the course of this project.

# References