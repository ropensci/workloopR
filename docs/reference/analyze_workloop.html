<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Analyze work loop object to compute work and power output — analyze_workloop • workloopR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Analyze work loop object to compute work and power output — analyze_workloop" />
<meta property="og:description" content="Compute work and power output from a work loop experiment on a per-cycle
basis." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">workloopR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Introduction-to-workloopR.html">Introduction to workloopR</a>
    </li>
    <li>
      <a href="../articles/non-ddf-sources.html">Importing data from non .ddf sources</a>
    </li>
    <li>
      <a href="../articles/Calculating-twitch-kinetics.html">Working with isometric experiments</a>
    </li>
    <li>
      <a href="../articles/Analyzing-workloops.html">Analyzing work loop experiments</a>
    </li>
    <li>
      <a href="../articles/batch-processing.html">Batch processing</a>
    </li>
    <li>
      <a href="../articles/Plotting-workloopR.html">Plotting data in workloopR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vbaliga/workloopR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analyze work loop object to compute work and power output</h1>
    <small class="dont-index">Source: <a href='https://github.com/vbaliga/workloopR/blob/master/R/analysis_functions.R'><code>R/analysis_functions.R</code></a></small>
    <div class="hidden name"><code>analyze_workloop.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute work and power output from a work loop experiment on a per-cycle
basis.</p>
    </div>

    <pre class="usage"><span class='fu'>analyze_workloop</span>(<span class='no'>x</span>, <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>GR</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>M</span> <span class='kw'>=</span> -<span class='fl'>1</span>,
  <span class='kw'>vel_bf</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code>workloop</code> object of class <code>muscle_stim</code> that has been
passed through
<code>select_cycles</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>Logical. If <code>FALSE</code>, the full analyzed workloop
object is returned. If <code>TRUE</code> a simpler table of net work and power
(by cycle) is returned.</p></td>
    </tr>
    <tr>
      <th>GR</th>
      <td><p>Gear ratio, set to 1 by default</p></td>
    </tr>
    <tr>
      <th>M</th>
      <td><p>Velocity multiplier, set adjust the sign of velocity. This parameter
should generally be either -1 (the default) or 1.</p></td>
    </tr>
    <tr>
      <th>vel_bf</th>
      <td><p>Critical frequency (scalar) for low-pass filtering of velocity
via <code><a href='https://rdrr.io/pkg/signal/man/butter.html'>signal::butter()</a></code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments potentially passed down from
<code><a href='read_analyze_wl.html'>read_analyze_wl()</a></code> or <code><a href='read_analyze_wl_dir.html'>read_analyze_wl_dir()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a <code>list</code> of class <code>analyzed_workloop</code>
that provides instantaneous velocity, a smoothed velocity, and computes work,
 instantaneous power, and net power from a work loop experiment. All data are
 organized by the cycle number and important metadata are stored as
 Attributes.</p>
<p>Within the <code>list</code>, each entry is labeled by cycle and includes:</p>
<dt>Time</dt><dd><p>Time, in sec</p></dd>
<dt>Position</dt><dd><p>Length change of the muscle, corrected for gear ratio, in mm</p></dd>
<dt>Force</dt><dd><p>Force, corrected for gear ratio, in mN</p></dd>
<dt>Stim</dt><dd><p>When stimulation occurs, on a binary scale</p></dd>
<dt>Cycle</dt><dd><p>Cycle ID, as a letter</p></dd>
<dt>Inst_velocity</dt><dd><p>Instantaneous velocity, computed from <code>Position</code>
change, reported in meters/sec</p></dd>
<dt>Filt_velocity</dt><dd><p>Instantaneous velocity, after low-pass filtering, again
 in meter/sec</p></dd>
<dt>Inst_Power</dt><dd><p>Instantaneous power, a product of <code>Force</code> and
<code>Filt_velocity</code>, reported in J</p></dd>
<dt>Percent_of_Cycle</dt><dd><p>The percent of that particular cycle which has
elapsed</p></dd>

In addition, the following information is stored in the
analyzed_workloop object's attributes:
<dt>stimulus_frequency</dt><dd><p>Frequency at which stimulus pulses occurred</p></dd>
<dt>cycle_frequency</dt><dd><p>Frequency of oscillations (assuming sine wave
trajectory)</p></dd>
<dt>total_cycles</dt><dd><p>Total number of oscillatory cycles (assuming sine wave
trajectory) that the muscle experienced.</p></dd>
<dt>cycle_def</dt><dd><p>Specifies what part of the cycle is understood as the
beginning and end. There are currently three options:
'lo' for L0-to-L0;
'p2p' for peak-to-peak; and
't2t' for trough-to-trough</p></dd>
<dt>amplitude</dt><dd><p>Amplitude of length change (assuming sine wave
trajectory)</p></dd>
<dt>phase</dt><dd><p>Phase of the oscillatory cycle (in percent) at which stimulation
occurred. Somewhat experimental, please use with caution</p></dd>
<dt>position_inverted</dt><dd><p>Logical; whether position inversion has been
applied)</p></dd>
<dt>units</dt><dd><p>The units of measurement for each column in the object after
running this function. See Warning</p></dd>
<dt>sample_frequency</dt><dd><p>Frequency at which samples were collected</p></dd>
<dt>header</dt><dd><p>Additional information from the header</p></dd>
<dt>units_table</dt><dd><p>Units from each Channel of the original ddf file</p></dd>
<dt>protocol_table</dt><dd><p>Protocol in tabular format; taken from the original
ddf file</p></dd>
<dt>stim_table</dt><dd><p>Specific info on stimulus protocol; taken from the original
ddf file</p></dd>
<dt>stimulus_pulses</dt><dd><p>Number of sequential pulses within a stimulation
train</p></dd>
<dt>stimulus_offset</dt><dd><p>Timing offset at which stimulus began</p></dd>
<dt>gear_ratio</dt><dd><p>Gear ratio applied by this function</p></dd>
<dt>file_id</dt><dd><p>File name</p></dd>
<dt>mtime</dt><dd><p>Time at which file was last modified</p></dd>
<dt>retained_cycles</dt><dd><p>Which cycles were retained, as numerics</p></dd>
<dt>summary</dt><dd><p>Simple table showing work (in J) and net power (in W) for each
 cycle</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Please note that <code><a href='select_cycles.html'>select_cycles()</a></code> must be run on data prior to
using this function. This function relies on the input <code>muscle_stim</code>
object being organized by cycle number.</p>
<p>The <code>muscle_stim</code> object (<code>x</code>) must be a <code>workloop</code>,
preferably read in by one of our data import functions. Please see
documentation for <code><a href='as_muscle_stim.html'>as_muscle_stim()</a></code> if you need to manually construct
a <code>muscle_stim</code> object from a non .ddf source.</p>
<p>The gear ratio (GR) and velocity multiplier (M) parameters can help correct
for issues related to the magnitude and sign of data collection. By default,
they are set to apply no gear ratio adjustment and to positivize velocity.
Instantaneous velocity is often noisy and the <code>vel_bf</code> parameter allows
for low-pass filtering of velocity data. See <code><a href='https://rdrr.io/pkg/signal/man/butter.html'>signal::butter()</a></code> and
<code><a href='https://rdrr.io/pkg/signal/man/filtfilt.html'>signal::filtfilt()</a></code> for details of how filtering is achieved.</p>
<p>Please also be careful with units! Se Warning section below.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    

<p>Most systems we have encountered record Position data in millimeters
and Force in millinewtons, and therefore this function assumes data are
recorded in those units. Through a series of internal conversions, this
function computes velocity in meters/sec, work in Joules, and power in
Watts. If your raw data do not originate in millimeters and millinewtons,
please transform your data accordingly and ignore what you see in the
attribute <code>units</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Josephson RK. 1985. Mechanical Power output from Striated Muscle
 during Cyclic Contraction. Journal of Experimental Biology 114: 493-512.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='read_ddf.html'>read_ddf</a></code>,
<code><a href='read_analyze_wl.html'>read_analyze_wl</a></code>,
<code><a href='select_cycles.html'>select_cycles</a></code></p>
<p>Other data analyses: <code><a href='isometric_timing.html'>isometric_timing</a></code>,
  <code><a href='read_analyze_wl_dir.html'>read_analyze_wl_dir</a></code>,
  <code><a href='read_analyze_wl.html'>read_analyze_wl</a></code></p>
<p>Other workloop functions: <code><a href='fix_GR.html'>fix_GR</a></code>,
  <code><a href='get_wl_metadata.html'>get_wl_metadata</a></code>,
  <code><a href='invert_position.html'>invert_position</a></code>,
  <code><a href='read_analyze_wl_dir.html'>read_analyze_wl_dir</a></code>,
  <code><a href='read_analyze_wl.html'>read_analyze_wl</a></code>,
  <code><a href='select_cycles.html'>select_cycles</a></code>,
  <code><a href='summarize_wl_trials.html'>summarize_wl_trials</a></code>,
  <code><a href='time_correct.html'>time_correct</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>workloopR</span>)

<span class='co'># import the workloop.ddf file included in workloopR</span>
<span class='no'>wl_dat</span> <span class='kw'>&lt;-</span><span class='fu'><a href='read_ddf.html'>read_ddf</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"workloop.ddf"</span>,
                              <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>'workloopR'</span>),
                  <span class='kw'>phase_from_peak</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># select cycles 3 through 5 via the peak-to-peak definition</span>
<span class='no'>wl_selected</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select_cycles.html'>select_cycles</a></span>(<span class='no'>wl_dat</span>, <span class='kw'>cycle_def</span> <span class='kw'>=</span> <span class='st'>"p2p"</span>, <span class='kw'>keep_cycles</span> <span class='kw'>=</span> <span class='fl'>3</span>:<span class='fl'>5</span>)

<span class='co'># run the analysis function and get the full object</span>
<span class='no'>wl_analyzed</span> <span class='kw'>&lt;-</span> <span class='fu'>analyze_workloop</span>(<span class='no'>wl_selected</span>, <span class='kw'>GR</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'># print methods give a short summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>wl_analyzed</span>)</div><div class='output co'>#&gt; File ID: workloop.ddf
#&gt; Cycles: 3 cycles kept out of 6
#&gt; Mean Work: 0.00308 J
#&gt; Mean Power: 0.08474 W
#&gt; </div><div class='input'>
<span class='co'># summary provides a bit more detail</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>wl_analyzed</span>)</div><div class='output co'>#&gt; # Workloop Data:
#&gt; 
#&gt; 
#&gt; File ID: workloop.ddf
#&gt; Mod Time (mtime): 2019-10-24 09:40:55
#&gt; Sample Frequency: 10000Hz
#&gt; 
#&gt; data.frame Columns: 
#&gt;   Position (mm)
#&gt;   Force (mN)
#&gt;   Stim (TTL)
#&gt;   Cycle (letters)
#&gt;   Inst_Velocity (m/s)
#&gt;   Filt_Velocity (m/s)
#&gt;   Inst_Power (W)
#&gt;   Percent_of_Cycle (NA)
#&gt; 
#&gt; Stimulus Offset: 0.012s
#&gt; Stimulus Frequency: 300Hz
#&gt; Stimulus Width: 0.2ms
#&gt; Stimulus Pulses: 4
#&gt; Gear Ratio: 2
#&gt; 
#&gt; Cycle Frequency: 28Hz
#&gt; Total Cycles (peak-to-peak): 6
#&gt; Cycles Retained: 3
#&gt; Amplitude: 1.575mm
#&gt; 
#&gt; 
#&gt;   Cycle        Work  Net_Power
#&gt; a     A 0.002785397 0.07639783
#&gt; b     B 0.003147250 0.08661014
#&gt; c     C 0.003305744 0.09122522</div><div class='input'>
<span class='co'># run the analysis but get the simplified version</span>
<span class='no'>wl_analyzed_simple</span> <span class='kw'>&lt;-</span> <span class='fu'>analyze_workloop</span>(<span class='no'>wl_selected</span>, <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>GR</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#warning">Warning</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Vikram B. Baliga and Shreeram Senthivasan</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.vikram-baliga.com/'>Vikram B. Baliga</a>, <a href='https://www.zoology.ubc.ca/person/shreeram-senthivasan/'>Shreeram Senthivasan</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


